library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
?clara
library(cluster)
?clara
?clara
library(cluster)
library(cluster)
?clara
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
?clara
load("../../Rdata/d_wide_imputed.Rdata", verbose = TRUE)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard")
clara_n$diss
load("../../Rdata/d_wide_imputed.Rdata", verbose = TRUE)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
library(cluster)
?clara
load("../../Rdata/d_wide_imputed.Rdata", verbose = TRUE)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
library(cluster)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
library(cluster)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
clara_n$diss
source("00_functions_jaccard_like_distance.R")
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = NA)
jaccard_dist
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
source("../00_functions_jaccard_like_distance.R")
source("../../00_functions_jaccard_like_distance.R")
source("../../00_libraries.R")
source("../../00_functions_jaccard_like_distance.R")
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = NA)
jaccard_dist
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
clara_n$diss
round(as.matrix(clara_n$diss), digits = 4)
jaccard_dist
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
library(cluster)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = NA, r = 0.7)
clara_n$diss
jaccard_dist
length(-18:7)
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = rep(1,26), r = 0.7)
clara_n$diss
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = rep(1,26), r = 0.7)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = rep(1,26))
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = rep(0.5,26), r = 0.7)
clara_n$diss
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = rep(-1,26), r = 0.7)
clara_n$diss
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = rep(-1,26), r = 0.7)
clara_n$diss
rep(-1,26)>0
w
w = rep(-1, 26)
w = rep(-1, 26)
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = w)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
rm(clara_n, jaccard_dist )
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
library(cluster)
w = rep(-1, 26)
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
library(cluster)
w = rep(1, 26)
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = w)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
w
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = w)
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = NA)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
clara_n$diss
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = NA)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
d_wide[1:4,-1]
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = w)
source("../../00_functions_jaccard_like_distance.R")
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = w)
jaccard_dist
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1], r = 0.7, w = w)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
w = rep(1, 26)
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.7)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1],  w = w, r = 0.7)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = 0.8)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1],  w = w, r = 0.8)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
w = rep(1, 26)
r = 0.7
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1],  w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
w = rep(0.5, 26)
r = 0.7
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(d_wide[1:4,-1],  w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
library(cluster)
### CLARA
clara_n = clara(d_wide[1:4,-1], k = 2, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
M = d_wide[1:4,-1]
### CLARA
clara_n = clara(M , k = 2, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,  w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
source("../../00_functions_jaccard_like_distance.R")
w = rep(0.5, 26)
r = 0.7
M = d_wide[1:4,-1]
### CLARA
clara_n = clara(M , k = 2, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
c1 = c(-1,-1,-1,0,0,0,1,1,1)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1 )
c1 = c(-1,-1,-1,0,0,0,1,1,1)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
M
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
M = d_wide[1:4,-1]
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = rep(0.5, ncol(M))
r = 0.7
w
M
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = rep(1, ncol(M))
r = 0.7
M
w
### CLARA
clara_n = clara(M , k = 2, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
1 - 0.7*1.5/6.5-0.3*6/11
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
w
M
1.5/6.5
0.7*1.5/6.5
1- 0.7*1.5/6.5
6/11
0.3*6/11
1- 0.7*1.5/6.5 - 0.3*6/11
M = as.matrix(M)
M
w
M_symptoms = M;
M_symptoms
M_symptoms[M_symptoms<0] = 0
M_symptoms
M_symptoms = sweep(M_symptoms,MARGIN=2,w,`*`)
M_symptoms
M_any_log = 1*(M>=0);
M_any_log = sweep(M_any_log,MARGIN=2,w,`*`)
M_any_log
M
N = nrow(M_symptoms)
N
J = matrix(0, N, N)
J
i = 1
j = 2
sum(pmin(M_symptoms[i,],M_symptoms[j,]))
sum(pmax(M_symptoms[i,],M_symptoms[j,]))
pmax(M_symptoms[i,],M_symptoms[j,])
I1 = sum(pmin(M_symptoms[i,],M_symptoms[j,]))/sum(pmax(M_symptoms[i,],M_symptoms[j,]))
I1
1- 0.7*1.5/7 - 0.3*6/11
jaccard_dist
clara_n$diss
new_jaccard_R = function(M_symptoms, M_any_log, r, w){
N = nrow(M_symptoms)
J = matrix(0, N, N)
for(i in 1:(N-1)){
for(j in (i+1):N){
I1 = sum(pmin(M_symptoms[i,],M_symptoms[j,]))/sum(pmax(M_symptoms[i,],M_symptoms[j,]))
I0 = sum(pmin(M_any_log[i,],M_any_log[j,]))/sum(pmax(M_any_log[i,],M_any_log[j,]))
d = 1 - r*I1 - (1-r)*I0
J[i,j] = d
J[j,i] = d
}
}
}
w
r
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
0.4545455*2
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
r
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
library(cluster)
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, r = r)
clara_n$diss
library(cluster)
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
w = rep(0.123456789, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
library(cluster)
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
library(cluster)
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
1-6/11
library(cluster)
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
library(cluster)
c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
M = d_wide[1:4,-1]
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
M
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
source("../../00_functions_jaccard_like_distance.R")
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
w = rep(0.5, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
w = rep(1, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
(1:ncol(M))/ncol(M)
w = (1:ncol(M))/ncol(M) # rep(0.5, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
library(cluster)
M = d_wide[1:4,-1]
w = (1:ncol(M))/ncol(M) # rep(0.5, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
source("../../00_functions_jaccard_like_distance.R")
M = d_wide[1:4,-1]
w = (1:ncol(M))/ncol(M) # rep(0.5, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
M = d_wide[1:10,-1]
rm(clara_n, jaccard_dist )
M = d_wide[1:10,-1]
#c1 = c(-1,-1,-1,0,0,0,1,1,1, 0.5, 0.5, 0.5)
#c2 = c(-1, 0, 1,-1,0, 1, -1, 0, 1,  -1, 0, 1 )
#M = matrix(c(c1, c2), nrow = 2, ncol = length(c1),byrow = TRUE)
w = (1:ncol(M))/ncol(M) # rep(0.5, ncol(M))
r = 0.7
### CLARA
clara_n = clara(M , k = 1, metric = "custom_jaccard", w = w, cjratio = r)
clara_n$diss
### RCCP
jaccard_dist = new_jaccard(M ,w = w, r = r)
jaccard_dist
round(as.matrix(clara_n$diss), digits = 4)
all(round(as.matrix(clara_n$diss), digits = 4) == round(jaccard_dist, digits = 4))
rm(clara_n, jaccard_dist )
library(cluster)
?clara
?clara
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
library(cluster)
?clara
clara(matrix(1:100,10,10), metric = "custom_jaccard")
clara(matrix(1:100,10,10), metric = "custom_jaccard", k = 2)
clara_test = clara(matrix(rnorm(100),10,10), metric = "custom_jaccard", k = 2)
clara_test
clara_test$clusinfo
clara_test$clustering\
clara_test$clustering
clara_test$diss
clara_test$silinfo
