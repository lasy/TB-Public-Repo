h = hclust(d, method = "ward.D")
c = cutree(h, k = 2)
# dbscan
out_dbscan = dbscan(Xmat, eps = 0.05, minPts = 5)
X = data.frame(x = Xmat[,1], y = Xmat[,2],
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = c(rep(1,200),rep(2, 200),rep(3, 200)),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
out_dbscan = dbscan(Xmat, eps = 0.1, minPts = 5) #eps = 0.05
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
out_dbscan = dbscan(Xmat, eps = 0.75, minPts = 5) #eps = 0.05
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
out_dbscan = dbscan(Xmat, eps = 0.075, minPts = 5) #eps = 0.05
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
out_dbscan = dbscan(Xmat, eps = 0.06, minPts = 5) #eps = 0.05
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
out_dbscan = dbscan(Xmat, eps = 0.05, minPts = 25)
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
out_dbscan = dbscan(Xmat, eps = 0.05, minPts = 15)
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
head(out_dbscan$cluster)
unique(out_dbscan$cluster)
out_dbscan
out_dbscan = dbscan(Xmat, eps = 0.05, minPts = 10)
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
set.seed(4)
Xmat_1 = matrix(rnorm(400, 0.25, 0.1), ncol = 2)
Xmat_2 = matrix(rnorm(400, 0.75, 0.2), ncol = 2)
Xmat=rbind(Xmat_1, Xmat_2, matrix(runif(400),ncol=2))
# k-means
out_kmeans = kmeans(Xmat, centers = 2)
# hierarchical
d = dist(Xmat)
h = hclust(d, method = "ward.D")
c = cutree(h, k = 2)
# dbscan
out_dbscan = dbscan(Xmat, eps = 0.05, minPts = 5)
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
h
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
plot(h)
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
data(iris)iris <- as.matrix(iris[,1:4])## find suitable eps parameter using a k-NN plot for k = dim + 1## Look for the knee!kNNdistplot(iris, k = 5)abline(h=.5, col = "red", lty=2)res <- dbscan(iris, eps = .5, minPts = 5)respairs(iris, col = res$cluster + 1L)## use precomputed frNNfr <- frNN(iris, eps = .5)dbscan(fr, minPts = 5)## example data from fpcset.seed(665544)n <- 100x <- cbind(x = runif(10, 0, 10) + rnorm(n, sd = 0.2),y = runif(10, 0, 10) + rnorm(n, sd = 0.2))res <- dbscan(x, eps = .3, minPts = 3)res## plot clusters and add noise (cluster 0) as crosses.plot(x, col=res$cluster)points(x[res$cluster==0,], pch = 3, col = "grey")hullplot(x, res)
kNNdistplot(iris, k = 5)
data(iris)
iris <- as.matrix(iris[,1:4])
## find suitable eps parameter using a k-NN plot for k = dim + 1## Look for the knee!
kNNdistplot(iris, k = 5)
kNNdistplot(Xmat, k = 3) #k = dim+1
set.seed(4)
Xmat_1 = matrix(rnorm(400, 0.25, 0.1), ncol = 2)
Xmat_2 = matrix(rnorm(400, 0.75, 0.2), ncol = 2)
Xmat=rbind(Xmat_1, Xmat_2, matrix(runif(400),ncol=2))
# k-means
out_kmeans = kmeans(Xmat, centers = 2)
# hierarchical
d = dist(Xmat)
h = hclust(d, method = "ward.D")
c = cutree(h, k = 2)
out_dbscan = dbscan(Xmat, eps = 0.05, minPts = 5)
out_dbscan
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
plot(h)
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
Xmat_1 = matrix(rnorm(400, 0.25, 0.1), ncol = 2)
Xmat_2 = matrix(rnorm(400, 0.75, 0.2), ncol = 2)
Xmat_3 = matrix(runif(400),ncol=2)
Xmat=rbind(Xmat_1, Xmat_2, Xmat_3)
set.seed(4)
Xmat_1 = matrix(rnorm(400, 0.25, 0.1), ncol = 2)
Xmat_2 = matrix(rnorm(400, 0.75, 0.2), ncol = 2)
Xmat_3 = matrix(runif(400),ncol=2)
Xmat=rbind(Xmat_1, Xmat_2, Xmat_3)
# k-means
out_kmeans = kmeans(Xmat, centers = 2)
# hierarchical
d = dist(Xmat)
h = hclust(d, method = "ward.D")
c = cutree(h, k = 2)
# dbscan
out_dbscan = dbscan(Xmat, eps = 0.05, minPts = 5)
out_dbscan
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
plot(h)
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
data(iris)
iris <- as.matrix(iris[,1:4])
## find suitable eps parameter using a k-NN plot for k = dim + 1## Look for the knee!
kNNdistplot(iris, k = 5)
abline(h=.5, col = "red", lty=2)
res <- dbscan(iris, eps = .5, minPts = 5)
respairs(iris, col = res$cluster + 1L)
res <- dbscan(iris, eps = .5, minPts = 5)
res
pairs(iris, col = res$cluster + 1L)
fr <- frNN(iris, eps = .5)
dbscan(fr, minPts = 5)
set.seed(665544)
n <- 100
x <- cbind(x = runif(10, 0, 10) + rnorm(n, sd = 0.2),y = runif(10, 0, 10) + rnorm(n, sd = 0.2))
res <- dbscan(x, eps = .3, minPts = 3)
res
plot(x, col=res$cluster)
points(x[res$cluster==0,], pch = 3, col = "grey")
hullplot(x, res)
set.seed(665544)
n <- 100
x <- cbind(x = runif(10, 0, 10) + rnorm(n, sd = 0.2),y = runif(10, 0, 10) + rnorm(n, sd = 0.2))
res <- dbscan(x, eps = .3, minPts = 3)
res
## plot clusters and add noise (cluster 0) as crosses.
plot(x, col=res$cluster)
points(x[res$cluster==0,], pch = 3, col = "grey")
hullplot(x, res)
kNNdistplot(Xmat, k = 3) #k = dim+1
abline(h=.08, col = "red", lty=2) # the knee is ~ for dist = 0.08
# dbscan
kNNdistplot(Xmat, k = 3) #k = dim+1 # we look for the knee
abline(h=.08, col = "red", lty=2) # the knee is ~ for dist = 0.08
out_dbscan = dbscan(Xmat, eps = 0.08, minPts = 5) # eps = 0.05
out_dbscan
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
plot(h)
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
# dbscan
kNNdistplot(Xmat, k = 3) #k = dim+1 # we look for the knee
abline(h=.08, col = "red", lty=2) # the knee is ~ for dist = 0.08
# dbscan
kNNdistplot(Xmat, k = 3) #k = dim+1 # we look for the knee
abline(h=.06, col = "red", lty=2) # the knee is ~ for dist = 0.08
out_dbscan = dbscan(Xmat, eps = 0.08, minPts = 5) # eps = 0.05
out_dbscan
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
plot(h)
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
out_dbscan = dbscan(Xmat, eps = 0.06, minPts = 5) # eps = 0.05
out_dbscan
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
plot(h)
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
hullplot(Xmat, out_dbscan)
knitr::opts_chunk$set(echo = TRUE)
library("ggplot2")
library("dbscan")
set.seed(952224887)
Xmat=matrix(runif(200),ncol=2)
nk=3
cents=matrix(runif(2*nk),ncol=2)
out=kmeans(Xmat,centers = nk) # give the # of clusters
out=kmeans(Xmat,centers = cents) # give the seeds (initial center of clusters)
X = data.frame(x = Xmat[,1], y = Xmat[,2], cluster = factor(out$cluster))
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point()
g + geom_point(aes(col = cluster))
out1=kmeans(Xmat,cents,iter.max=1)
out2=kmeans(Xmat,cents,iter.max=2)
out3=kmeans(Xmat,cents,iter.max=3)
X$cluster1 = factor(out1$cluster)
X$cluster2 = factor(out2$cluster)
X$cluster3 = factor(out3$cluster)
head(X)
out1
cents
cents_df = data.frame(x = cents[,1], y = cents[,2])
out$centers
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = 1:3), shape = "+")
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = 1:3), shape = "+")
cents_out = data.frame(x = out$centers[,1], y = out$centers[,2])
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = 1:3), shape = "+")
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = 1:3), shape = "+")
Xmat=matrix(runif(200),ncol=2)
nk=3
cents=matrix(runif(2*nk),ncol=2)
out=kmeans(Xmat,centers = nk) # give the # of clusters
out=kmeans(Xmat,centers = cents) # give the seeds (initial center of clusters)
X = data.frame(x = Xmat[,1], y = Xmat[,2], cluster = factor(out$cluster))
cents_df = data.frame(x = cents[,1], y = cents[,2], num = factor(1:3))
cents_out = data.frame(x = out$centers[,1], y = out$centers[,2], num = factor(1:3))
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = num), shape = "+")
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = num), shape = "+")
set.seed(952224887)
Xmat=matrix(runif(200),ncol=2)
nk=3
cents=matrix(runif(2*nk),ncol=2)
out=kmeans(Xmat,centers = nk) # give the # of clusters
out=kmeans(Xmat,centers = cents) # give the seeds (initial center of clusters)
X = data.frame(x = Xmat[,1], y = Xmat[,2], cluster = factor(out$cluster))
cents_df = data.frame(x = cents[,1], y = cents[,2], num = factor(1:3))
cents_out = data.frame(x = out$centers[,1], y = out$centers[,2], num = factor(1:3))
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = num), shape = "+", size = 2)
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = num), shape = "+", size = 2)
set.seed(952224887)
Xmat=matrix(runif(200),ncol=2)
nk=3
cents=matrix(runif(2*nk),ncol=2)
out=kmeans(Xmat,centers = nk) # give the # of clusters
out=kmeans(Xmat,centers = cents) # give the seeds (initial center of clusters)
X = data.frame(x = Xmat[,1], y = Xmat[,2], cluster = factor(out$cluster))
cents_df = data.frame(x = cents[,1], y = cents[,2], num = factor(1:3))
cents_out = data.frame(x = out$centers[,1], y = out$centers[,2], num = factor(1:3))
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = num), shape = "+", size = 20)
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = num), shape = "+", size = 20)
set.seed(952224887)
Xmat=matrix(runif(200),ncol=2)
nk=3
cents=matrix(runif(2*nk),ncol=2)
out=kmeans(Xmat,centers = nk) # give the # of clusters
out=kmeans(Xmat,centers = cents) # give the seeds (initial center of clusters)
X = data.frame(x = Xmat[,1], y = Xmat[,2], cluster = factor(out$cluster))
cents_df = data.frame(x = cents[,1], y = cents[,2], num = factor(1:3))
cents_out = data.frame(x = out$centers[,1], y = out$centers[,2], num = factor(1:3))
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = num), shape = "+", size = 10)
set.seed(952224887)
Xmat=matrix(runif(200),ncol=2)
nk=3
cents=matrix(runif(2*nk),ncol=2)
out=kmeans(Xmat,centers = nk) # give the # of clusters
out=kmeans(Xmat,centers = cents) # give the seeds (initial center of clusters)
X = data.frame(x = Xmat[,1], y = Xmat[,2], cluster = factor(out$cluster))
cents_df = data.frame(x = cents[,1], y = cents[,2], num = factor(1:3))
cents_out = data.frame(x = out$centers[,1], y = out$centers[,2], num = factor(1:3))
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = num), shape = "+", size = 10)
out1=kmeans(Xmat,cents,iter.max=1)
out2=kmeans(Xmat,cents,iter.max=2)
out3=kmeans(Xmat,cents,iter.max=3)
X$cluster1 = factor(out1$cluster)
X$cluster2 = factor(out2$cluster)
X$cluster3 = factor(out3$cluster)
cents_out1 = data.frame(x = out1$centers[,1], y = out1$centers[,2], num = factor(1:3))
cents_out2 = data.frame(x = out2$centers[,1], y = out2$centers[,2], num = factor(1:3))
cents_out3 = data.frame(x = out3$centers[,1], y = out3$centers[,2], num = factor(1:3))
X = rbind(X)
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster1))+ geom_point(data = cents_out1, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster2))+ geom_point(data = cents_out2, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster3))+ geom_point(data = cents_out3, aes(x = x, y = y, col = num), shape = "+", size = 10)
out1=kmeans(Xmat,cents,iter.max=1)
out1
out2=kmeans(Xmat,cents,iter.max=2)
out2
?kmeans
out1$iter
set.seed(952224887)
Xmat=matrix(runif(200),ncol=2)
nk=3
cents=matrix(runif(2*nk),ncol=2)
out=kmeans(Xmat,centers = nk) # give the # of clusters
out=kmeans(Xmat,centers = cents) # give the seeds (initial center of clusters)
X = data.frame(x = Xmat[,1], y = Xmat[,2], cluster = factor(out$cluster))
cents_df = data.frame(x = cents[,1], y = cents[,2], num = factor(1:3))
cents_out = data.frame(x = out$centers[,1], y = out$centers[,2], num = factor(1:3))
out1=kmeans(Xmat,cents,iter.max=1)
out2=kmeans(Xmat,cents,iter.max=2)
out3=kmeans(Xmat,cents,iter.max=3)
X$cluster1 = factor(out1$cluster)
X$cluster2 = factor(out2$cluster)
X$cluster3 = factor(out3$cluster)
cents_out1 = data.frame(x = out1$centers[,1], y = out1$centers[,2], num = factor(1:3))
cents_out2 = data.frame(x = out2$centers[,1], y = out2$centers[,2], num = factor(1:3))
cents_out3 = data.frame(x = out3$centers[,1], y = out3$centers[,2], num = factor(1:3))
g = ggplot(X, aes(x = x, y = y)) + xlab("") + ylab("") + guides(col = FALSE)
g + geom_point() + geom_point(data = cents_df, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster)) + geom_point(data = cents_out, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster1))+ geom_point(data = cents_out1, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster2))+ geom_point(data = cents_out2, aes(x = x, y = y, col = num), shape = "+", size = 10)
g + geom_point(aes(col = cluster3))+ geom_point(data = cents_out3, aes(x = x, y = y, col = num), shape = "+", size = 10)
out1$iter
out2$iter
out3$iter
set.seed(1)
Xmat=matrix(runif(20),ncol=2)
d = dist(Xmat)
d
dmat = as.matrix(d)
dmat[upper.tri(dmat, diag = TRUE)] = Inf
o = order(dmat, decreasing = FALSE)
X = data.frame(x = Xmat[,1], y = Xmat[,2], n = 1:nrow(Xmat))
g = ggplot(X, aes(x = x, y = y)) + coord_fixed()+ geom_point() + geom_text(aes(label = n), hjust=0, vjust=-0.65) + xlab("") + ylab("") + theme_light() # theme_few()
g
df_lines = data.frame()
for(k in 1:10){
cat(k,"\n")
a = (o[k]-1) %% ncol(dmat)+1
b = (o[k]-1) %/% ncol(dmat) + 1
xA = X$x[a]; yA = X$y[a]
xB = X$x[b]; yB = X$y[b]
df_lines = rbind(df_lines, data.frame(xA = X$x[a], yA = X$y[a], xB = X$x[b], yB = X$y[b]))
g = g + geom_segment(data = df_lines, aes(x = xA, y = yA, xend = xB, yend = yB), col = "red")
print(g)
}
clust = hclust(d, method = "ward.D")
plot(clust)
clust = hclust(d, method = "complete")
plot(clust)
set.seed(4)
Xmat_1 = matrix(rnorm(400, 0.25, 0.1), ncol = 2)
Xmat_2 = matrix(rnorm(400, 0.75, 0.2), ncol = 2)
Xmat_3 = matrix(runif(400),ncol=2)
Xmat=rbind(Xmat_1, Xmat_2, Xmat_3)
# k-means
out_kmeans = kmeans(Xmat, centers = 2)
# hierarchical
d = dist(Xmat)
h = hclust(d, method = "ward.D")
c = cutree(h, k = 2)
# dbscan
kNNdistplot(Xmat, k = 3) #k = dim+1 # we look for the knee
abline(h=.06, col = "red", lty=2) # the knee is ~ for dist = 0.08
out_dbscan = dbscan(Xmat, eps = 0.06, minPts = 5) # eps = 0.05
out_dbscan
# hullplot(Xmat, out_dbscan)
X = data.frame(x = Xmat[,1], y = Xmat[,2],
true = factor(c(rep(1,200),rep(2, 200),rep(3, 200))),
kmeans = factor(out_kmeans$cluster),
hierarchical = factor(c),
dbscan = factor(out_dbscan$cluster)
)
g = ggplot(X, aes(x = x, y = y)) + coord_fixed() + xlab("") + ylab("")
g + geom_point() + ggtitle("dataset")
g + geom_point(aes(col = kmeans)) + ggtitle("k-means")
g + geom_point(aes(col = hierarchical)) + ggtitle("hierarchical")
plot(h)
g + geom_point(aes(col = dbscan)) + ggtitle("dbscan")
g + geom_point(aes(col = true)) + ggtitle("'true' labels")
